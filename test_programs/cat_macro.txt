%macro load_addr(addr, rd)
	lui %2, %hi(%1)	        ; addr[31..12] -> rd[31..12]
	ori %2, %2, %lo(%1)	    ; addr[11..0] -> rd[11..0]
	lw %2, %2, 0            ; mem[addr] -> rd
%endmacro

.org 10
.data
    in_addr:    0
    out_addr:   1

.org 14
.code
	load_addr(in_addr, s1)
	load_addr(out_addr, s2)

	lw s3, s1, 0			        ; mem[s1] -> s3. Загрузили длины строки (счетчик) в s3

loop:
	addi s3, s3, -1			        ; s3-1 -> s3
	beq s3, r0, end			        ; if s3 == 0 go to end

	lw s4, s1, 0			        ; mem[s1] -> s4. Символ в s4
	sw s2, s4, 0			        ; s4 -> mem[s2]. Вывести символ

	jal r0, loop

end:
	halt
